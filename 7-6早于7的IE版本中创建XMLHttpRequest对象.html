<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>my page</title>
</head>

<body>
  <script>
    // var xhr = new ActiveXObject('MSXML2.XMLHTTP.3.0');
    /**
     * xhr创建过程
     * @type {Array}
     */
    var ids = ['MSXML2.XMLHTTP.3.0',
                'MSXML2.XMLHTTP',
                'Microsoft.XMLHTTP'];
    var xhr;

    if(typeof window.XMLHttpRequest === 'function') {
      xhr = new XMLHttpRequest();
    } else (
      for (var i = 0; i < ids.length; i++) {
        try{
          xhr = new ActiveXObject(ids[i]);
          break;
        } catch(e) {}
      }
    )
  </script>
</body>

</html>
